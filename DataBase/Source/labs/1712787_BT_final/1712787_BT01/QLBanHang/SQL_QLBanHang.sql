USE master
GO
--b1: toa csdl
IF DB_ID('QLBanHang') IS NOT NULL
DROP DATABASE QLBanHang
GO

CREATE DATABASE QLBanHang
GO

USE QLBanHang
GO

CREATE TABLE KHACH_HANG
(
MaKH CHAR(10) PRIMARY KEY,
HoTen NVARCHAR(40),
GioiTinh NCHAR(3),
DienThoai CHAR(15),
DiaChi NVARCHAR(100)

)
GO

CREATE TABLE SAN_PHAM
(
MaSP CHAR(10) PRIMARY KEY,
TenSp NVARCHAR(40),
NgaySX DATE, 
DonGia FLOAT

)
GO

CREATE TABLE CT_HOA_DON
(
MaHD CHAR(10) PRIMARY KEY,
MaSP CHAR(10),
SoLuong INT,
DonGia FLOAT

)
GO

CREATE TABLE HOA_DON
(
MaHD CHAR(10) PRIMARY KEY,
NgayLap DATE,
MaKH CHAR(10)

)
GO

-------------------
ALTER TABLE HOA_DON ADD
CONSTRAINT FK_HOA_DON_KHACH_HANG
FOREIGN KEY(MaKH)
REFERENCES KHACH_HANG(MaKH)

ALTER TABLE CT_HOA_DON ADD
CONSTRAINT FK_CT_HOA_DON_SAN_PHAM
FOREIGN KEY(MaSP)
REFERENCES SAN_PHAM(MaSP),
CONSTRAINT FK_CT_HOA_DON_HOA_DON
FOREIGN KEY(MaHD)
REFERENCES HOA_DON(MaHD)

------------------------------

INSERT INTO KHACH_HANG (MaKH,HoTen,GioiTinh,DienThoai,DiaChi) VALUES ('KH01',N'Trần Bạch Tuyết',N'Nữ','0987121216',N'127 Hùng Vương, Q. Thủ Đức, TP HCM')
INSERT INTO KHACH_HANG (MaKH,HoTen,GioiTinh,DienThoai,DiaChi) VALUES ('KH02',N'Nguyễn Lâm Trung',N'Nam','0987145211',N'234 3/2, TP Biên Hòa')
INSERT INTO KHACH_HANG (MaKH,HoTen,GioiTinh,DienThoai,DiaChi) VALUES ('KH03',N'Hoàng Trung Hiếu',N'Nam','0987645219',N'22/11 Lý Thường Kiệt, Q.1, TP HCM')
INSERT INTO KHACH_HANG (MaKH,HoTen,GioiTinh,DienThoai,DiaChi) VALUES ('KH04',N'Trần Hoàng Nhật Nam',N'Nam','0987568210',N'234 Trấn Não, Q.2, TP HCM')
INSERT INTO KHACH_HANG (MaKH,HoTen,GioiTinh,DienThoai,DiaChi) VALUES ('KH05',N'Phạm Thị Thanh Bình',N'Nữ','0987000343',N'22 Hùng Vương, Q.5, TP HCM')

INSERT INTO SAN_PHAM (MaSP,TenSp,NgaySX,DonGia) VALUES ('SP01','Banh01','6/7/2018','6300.5')
INSERT INTO SAN_PHAM (MaSP,TenSp,NgaySX,DonGia) VALUES ('SP02','Banh02','5/8/2018','7020')
INSERT INTO SAN_PHAM (MaSP,TenSp,NgaySX,DonGia) VALUES ('SP03','Banh03','4/9/2018','8050.09')
INSERT INTO SAN_PHAM (MaSP,TenSp,NgaySX,DonGia) VALUES ('SP04','Banh04','3/10/2018','9910.54')
INSERT INTO SAN_PHAM (MaSP,TenSp,NgaySX,DonGia) VALUES ('SP05','Banh05','2/11/2018','10010.1')

INSERT INTO HOA_DON (MaHD,NgayLap,MaKH) VALUES ('HD01','7/3/2018','KH01')
INSERT INTO HOA_DON (MaHD,NgayLap,MaKH) VALUES ('HD02','3/5/2018','KH02')
INSERT INTO HOA_DON (MaHD,NgayLap,MaKH) VALUES ('HD03','5/6/2018','KH03')
INSERT INTO HOA_DON (MaHD,NgayLap,MaKH) VALUES ('HD04','10/10/2018','KH04')
INSERT INTO HOA_DON (MaHD,NgayLap,MaKH) VALUES ('HD05','12/12/2018','KH05')

INSERT INTO CT_HOA_DON (MaHD,MaSP,SoLuong,DonGia) VALUES ('HD01',NULL,'100','5000')
INSERT INTO CT_HOA_DON (MaHD,MaSP,SoLuong,DonGia) VALUES ('HD02',NULL,'200','8000')
INSERT INTO CT_HOA_DON (MaHD,MaSP,SoLuong,DonGia) VALUES ('HD03',NULL,'300','10000')
INSERT INTO CT_HOA_DON (MaHD,MaSP,SoLuong,DonGia) VALUES ('HD04',NULL,'400','30000')
INSERT INTO CT_HOA_DON (MaHD,MaSP,SoLuong,DonGia) VALUES ('HD05',NULL,'500','50000')

SELECT * FROM dbo.KHACH_HANG
SELECT * FROM dbo.SAN_PHAM
SELECT * FROM dbo.HOA_DON
SELECT * FROM dbo.CT_HOA_DON